**总体结构**
- 顶部栏：左侧`局数`，中间`人数切换（2人/3人）`，右侧`设置`与`撤销`按钮。
- 玩家区：横向分布玩家卡片（2或3列），头像+昵称，上方选中态，下方大号比分。
- 操作区：横向展示五个操作按钮：`犯规`、`普胜`、`小金`、`大金`、`黄金9`。
- 统计区：左右（或三列）卡片展示该玩家的五类累计次数。
- 底部栏：居中大按钮`结束比赛`。

**顶部信息**
- 局数展示：文案如“局数 12”，当触发`普胜/小金/大金/黄金9`任一操作（按规则分值执行）时，局数+1；`犯规`不计入局数。
- 人数切换：`2人追`与`3人追`切换；切换后玩家区和记分行为联动变化。
- 设置按钮：点击弹出规则设置弹窗（详见“规则弹窗”）。
- 撤销按钮：撤销最后一次操作，回滚对应玩家分数与局数，需维护操作栈。

**玩家区块**
- 布局：2人模式为左右两列等分；3人模式为三列等分。
- 头像与昵称：默认本地头像，默认姓名（如“玩家A/玩家B/玩家C”）；支持长按头像唤起重命名，校验“仅中文，最多4字”，保存后全局使用。
- 分数：默认显示`100分`，位于昵称下方，字号大、对比度高；选中时卡片高亮（边框+浅色底）。
- 选中逻辑：
  - 2人：点击某玩家卡片选中他为“本次操作归属”；操作按钮加分给选中者，并按规则扣对手分。
  - 3人：点击“赢的玩家”卡片后，再弹出输家选择（两个其他玩家头像按弹窗展示）。若操作类型是`黄金9/大金`，则直接同时扣另外两家，不弹选择。

**操作区**
- 五个按钮等宽等高、横向排列、色彩清晰：
  - 犯规：警示红色
  - 普胜：主色蓝/成功绿（二选一致，建议蓝）
  - 小金：强调色（例如橙/次主蓝）
  - 大金：主色蓝或强调色
  - 黄金9：强调色（例如橙）
- 点击即生效：根据当前模式（2人/3人）与设置规则分值，完成加/扣分与局数更新；顶部刷新“上一操作”提示。

**规则弹窗**
- 入口：顶部`设置`按钮。
- 项目与默认值：
  - 犯规：数字输入，默认`1分`
  - 普胜：数字输入，默认`4分`
  - 小金：数字输入，默认`7分`
  - 大金：数字输入，默认`10分`
    - 分配选项：`2人上家给分`、`3人两家给分`
  - 黄金9：数字输入，默认`4分`
    - 分配选项：`2人上家给分`、`3人两家给分`
- 操作：
  - “确定”保存：写入本地缓存并应用到当前比赛
  - “取消”关闭：不更改当前规则
- 校验与提示：数值必填且为正整数；选项必须选择；保存后顶部短Toast提示“规则已应用”。

**记分规则（应用设置中的分值）**
- 犯规：给选中玩家加“犯规分”，并扣对手分（2人）；3人模式下仅扣输家分（若被选择），黄金9/大金例外为两家直接扣。
- 普胜、小金、大金、黄金9：
  - 2人：选中者加分，对手扣分
  - 3人：选中赢者加分，再选择输者扣分；若为`黄金9/大金`，另外两家直接各自扣分，不需选择输者
- 分数允许为负数，无下限约束。
- 局数：当`普胜/小金/大金/黄金9`发生时，局数+1；`犯规`不加局数。

**统计与历史**
- 统计卡片（每玩家）：五个项目累计次数展示，格式“犯规/普胜/小金/大金/黄金9”对齐排列；数值使用徽章/Tag风格便于对比。
- 顶部“上一操作”提示：例如“上一操作：玩家A 大金”，帮助核对撤销内容。
- 历史归档：结束比赛后保存玩家姓名、结束时间、最终分数、五类次数与局数到本地。新比赛初始化分数与局数。

**结束比赛**
- 底部主按钮“结束比赛”：
  - 点击弹确认框：说明“结束后比分与局数将重置并写入本地”
  - 确认后操作：
    - 写入历史缓存（包括本次规则数值快照，便于追溯）
    - 清空操作栈
    - 重置比分为`0`（按你的需求文案，局数为`0`）
  - 完成反馈：Toast提示“本场数据已保存”

**撤销**
- 顶部“撤销”按钮：
  - 回滚最后一次操作的加/扣分、项目累计次数与局数
  - 若为3人模式、且涉及输家选择或双扣（黄金9/大金），按记录逐项回滚
  - 栈空时置灰不可用

**TDesign组件建议**
- 顶部栏与提示：
  - `t-icon`（设置图标/信息图标）
  - 自定义`view`作为导航容器（已在首页沿用自定义topbar风格）
- 人数切换：
  - 两项选项：用`t-tabs`（“2人追/3人追”）或`t-radio-group`
- 规则弹窗：
  - `t-dialog`（内容区放`t-stepper`数字输入与`t-radio-group`分配选项）
- 玩家区：
  - `t-avatar`（头像）
  - 卡片容器使用自定义样式，保持选中态一致性
- 操作区：
  - `t-button`（五个操作按钮，`size="large"`，`block`或横向栅格）
- 统计区：
  - `t-tag`（轻量Tag，主题色分别对应各项）
- 输家选择弹窗（3人追）：
  - `t-action-sheet`或`t-popup`+`grid`展示两个可选头像项

**数据结构建议**
- 规则缓存键：`zhuifen_rules`
  - `points`: `{ foul, normal, xiaojin, dajin, huangjin9 }`
  - `allocation`: `{ dajin: 'two'|'one', huangjin9: 'two'|'one' }`（two=两家给分，one=上家给分）
- 进行中比赛键：`zhuifen_match_current`
  - `mode`: `2|3`
  - `players`: 数组或字典（含`name`、`score`、五类次数）
  - `rounds`: 数字
  - `history`: 栈，元素含`op`、`winnerId`、`loserId`或`losers[]`、`delta`，用于撤销
- 历史归档键：`zhuifen_match_history`
  - 追加：`{ players, rounds, finishedAtISO, rulesSnapshot, mode }`

**交互细节**
- 长按头像改名：校验中文1-4字，保存并即时刷新各处姓名。
- 选中反馈：玩家卡片高亮，操作按钮生效后分数有轻微弹跳动画，顶部提示更新。
- 3人模式输家选择：弹窗内展示两个未选中的玩家头像，点击确认后执行扣分。
- 禁用态：无历史时`撤销`置灰；规则未配置时使用默认值。

**布局规范**
- rpx单位：延续首页统一的`rpx`适配；按钮与卡片间距采用`16rpx`基线，标题与比分字号分层更明显。
- 色彩：保证按钮主题色与统计Tag主题色一致（红/蓝/橙/绿等），对比度充足。
- 响应式：在窄屏下操作按钮可折行或用`grid`等分；三人模式卡片保持等宽。

若你确认以上布局方案，我可以在项目中创建“追分”页面的原型（包含规则弹窗、2/3人模式切换、赢/输选择弹窗、撤销栈、结束比赛归档、重命名），并与首页保持一致的风格和组件体系。