<view class="safe-page">
  <view class="card bg-card border-border glass">
    <view class="card-header">
      <t-tag size="small" shape="round" variant="light" theme="{{type=='8球'?'success':'warning'}}">{{type}}</t-tag>
      <text class="time text-muted-foreground">{{date}} {{time}}</text>
    </view>
    <view class="players {{players.length==3?'three':'two'}}">
      <block wx:for="{{players}}" wx:key="name">
        <view class="p">
          <view class="circle-large {{item.score==maxScore?'win':''}}">玩</view>
          <text class="pname {{item.score==maxScore?'win':''}}">{{item.name}}</text>
          <text class="score-x {{item.score==maxScore?'win':''}}">{{item.score}}</text>
        </view>
      </block>
    </view>
    <text class="round text-muted-foreground">{{totalRounds}} 总局数</text>
  </view>

  <view class="seg-tabs">
    <view class="seg-item {{seg=='stats'?'active':''}}" data-val="stats" bindtap="switchSeg">数据统计</view>
    <view class="seg-item {{seg=='card'?'active':''}}" data-val="card" bindtap="switchSeg">生成卡片</view>
  </view>

  <block wx:if="{{seg=='stats'}}">
    <view class="table bg-card border-border glass">
      <view class="tr header">
        <text class="th">统计项</text>
        <block wx:for="{{players}}" wx:key="name">
          <text class="th th-center">{{item.name}}</text>
        </block>
      </view>
      <block wx:for="{{statsRows}}" wx:key="label">
        <view class="tr">
          <text class="td label">{{item.label}}</text>
          <block wx:for="{{item.values}}" wx:key="idx">
            <text class="td val">{{item}}</text>
          </block>
        </view>
      </block>
    </view>
  </block>

  <block wx:if="{{seg=='card'}}">
    <view class="card-gen bg-card border-border glass">
      <text class="tip text-muted-foreground">暂未实现卡片生成</text>
    </view>
  </block>
</view>
