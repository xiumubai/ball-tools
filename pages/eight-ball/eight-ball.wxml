<view class="app cn-padding">
  <!-- Top Bar -->
  <view class="top">
    <view class="game-tag">{{modeLabel}}</view>
    <view class="timer" bindtap="onToggleTimer">
      <text class="time">{{timerText}}</text>
      <text class="pause-pill {{isRunning ? 'paused' : 'running'}}">{{isRunning ? '暂停' : '开始'}}</text>
    </view>
  </view>

  <!-- Scoreboard Panel -->
  <view class="panel">
    <view class="score-grid">
      <!-- Player A -->
      <view class="player-card {{selectedPlayer==='A'?'active':''}}" bindtap="selectA" bindlongpress="onRenameStart" data-target="A">
        <view class="player-name">{{names.A}}</view>
        <view class="score {{scoreAnimA}}">{{players.A.score}}</view>
      </view>
      
      <!-- Round Info -->
      <view class="round-card">
        <view class="round-tag">第 {{players.A.score + players.B.score + 1}} 局</view>
        <view class="vs">VS</view>
      </view>

      <!-- Player B -->
      <view class="player-card {{selectedPlayer==='B'?'active':''}}" bindtap="selectB" bindlongpress="onRenameStart" data-target="B">
        <view class="player-name">{{names.B}}</view>
        <view class="score {{scoreAnimB}}">{{players.B.score}}</view>
      </view>
    </view>

    <view class="hint">长按玩家姓名可以修改</view>

    <!-- Stats -->
    <view class="stats">
      <!-- Stats A -->
      <view class="stat-card">
        <view class="stat-title">{{names.A}}</view>
        <view class="stat-grid-inner">
          <view class="stat-item">
            <text class="stat-label">普胜</text>
            <text class="stat-val green">{{players.A.normal}}</text>
          </view>
          <view class="stat-item">
            <text class="stat-label">接清</text>
            <text class="stat-val blue">{{players.A.jieqing}}</text>
          </view>
          <view class="stat-item">
            <text class="stat-label">炸清</text>
            <text class="stat-val orange">{{players.A.zhaqing}}</text>
          </view>
          <view class="stat-item">
            <text class="stat-label">犯规</text>
            <text class="stat-val red">{{players.A.foul}}</text>
          </view>
        </view>
      </view>

      <!-- Stats B -->
      <view class="stat-card">
        <view class="stat-title">{{names.B}}</view>
        <view class="stat-grid-inner">
          <view class="stat-item">
            <text class="stat-label">普胜</text>
            <text class="stat-val green">{{players.B.normal}}</text>
          </view>
          <view class="stat-item">
            <text class="stat-label">接清</text>
            <text class="stat-val blue">{{players.B.jieqing}}</text>
          </view>
          <view class="stat-item">
            <text class="stat-label">炸清</text>
            <text class="stat-val orange">{{players.B.zhaqing}}</text>
          </view>
          <view class="stat-item">
            <text class="stat-label">犯规</text>
            <text class="stat-val red">{{players.B.foul}}</text>
          </view>
        </view>
      </view>
    </view>
  </view>

  <!-- Primary Actions -->
  <view class="actions">
    <view class="btn green" bindtap="onOp" data-type="normal">
        <text>普胜</text>
    </view>
    <view class="btn blue" bindtap="onOp" data-type="jieqing">
        <text>接清</text>
    </view>
    <view class="btn orange" bindtap="onOp" data-type="zhaqing">
        <text>炸清</text>
    </view>
    <view class="btn red-ghost" bindtap="onOp" data-type="foul">
        <text>犯规</text>
    </view>
  </view>

  <!-- Toolbar -->
  <view class="toolbar">
    <view class="tool" bindtap="onUndo">
      <t-icon name="rollback" size="36rpx" class="icon" />
      <text>撤销</text>
    </view>
    <view class="tool" bindtap="onRestart">
      <t-icon name="refresh" size="36rpx" class="icon" />
      <text>重开</text>
    </view>
    <view class="tool red" bindtap="onEndMatch">
      <t-icon name="stop-circle" size="36rpx" class="icon" />
      <text>结束</text>
    </view>
  </view>

  <!-- Rename Modal (Keep existing) -->
  <view class="rename-mask" wx:if="{{renameVisible}}">
    <view class="rename-dialog">
      <text class="rename-title">修改玩家姓名</text>
      <input class="rename-input" type="text" placeholder="请输入中文姓名" value="{{renameValue}}" bindinput="onRenameInput" confirm-type="done" />
      <view class="rename-actions">
        <button class="rename-btn cancel" bindtap="onRenameCancel">取消</button>
        <button class="rename-btn ok" type="primary" bindtap="onRenameSave">保存</button>
      </view>
    </view>
  </view>
</view>
